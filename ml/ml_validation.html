<!DOCTYPE html>
<html lang="en">
	<head>
		<meta charset="utf-8" />
		<link rel="icon" href="../favicon.png" />
		<meta name="viewport" content="width=device-width" />
		<meta http-equiv="content-security-policy" content="">
		<link href="../_app/immutable/assets/_layout.8634efe4.css" rel="stylesheet">
		<link href="../_app/immutable/assets/_page.8ebbd519.css" rel="stylesheet">
		<link rel="modulepreload" href="../_app/immutable/entry/start.515f0d26.js">
		<link rel="modulepreload" href="../_app/immutable/chunks/index.5621f243.js">
		<link rel="modulepreload" href="../_app/immutable/chunks/singletons.02becfe2.js">
		<link rel="modulepreload" href="../_app/immutable/entry/app.8b861ad3.js">
		<link rel="modulepreload" href="../_app/immutable/entry/_layout.svelte.f8856493.js">
		<link rel="modulepreload" href="../_app/immutable/entry/(posts)-_path_-_slug_-page.svelte.f5b1f45e.js">
	</head>
	<body data-sveltekit-preload-data="hover">
		<div style="display: contents">


<body><header><nav><div class="title"><a href="/">db&#39;Doodle</a></div>
		<div class="links"><ul><li><a href="/about">ABOUT</a></li>
				<li><a href="/blog">Blog</a></li>
				<li><a href="/ml">ML</a></li>
				<li><a href="/cs">CS</a></li>
				<li><a href="/tech">Tech</a></li></ul></div></nav></header>

	<div class="contents"><div class="post-title"><h1>Validation in ML</h1>
		<p>Cross Validation</p></div>
	

	<div class="metadata"><div class="metadata-img"><svg data-name="Layer 1" xmlns="http://www.w3.org/2000/svg" width="110" height="80" viewBox="0 0 786.81995 572.25773" xmlns:xlink="http://www.w3.org/1999/xlink"><g fill="#f2f2f2"><circle cx="458.3" cy="74.2" r="26.7"></circle><path d="M665.4 497.2C705 467 724 416 712.2 367.7q-.4-1.8-1-3.6c-8-28.8-27.3-56-55.7-65.3-23.8-7.7-49.8-1.8-74.7-5-48.8-6-86.6-45.5-113.2-86.8s-47-87.6-82.4-121.7C327 29 232 17 159.7 53.6s-118.3 118-116.3 199 50 158.4 120 199.5c25.7 15 55.3 25.8 84.8 22 25.6-3.2 49-17 74.4-21 40-6.4 80 11.7 114.6 32.8s68.2 46.2 107.6 56c38.3 9.5 85.7-17.8 120.8-44.6z"></path></g><g fill="#3f3d56"><path d="M608.4 55.3l-2.6-1.7a380 380 0 0 0-80.3-38.9L519 105h-41.5V1.5l-8-1.5v105h-49.3C364 105 318 59 318 2.7h0l-8 1.8V105h-40l-6.2-86a381 381 0 0 0-81.9 43.5l-1.3 1L174 68v344.2h118.3l-2-29-11.5-159h231.6l-11.5 159-2 29h117V58.8q-2.6-1.8-5.2-3.5zM310.2 198h-33.4l-6.2-85.3h39.6zm159.4 0h-56v-1.7c0-1.6-.7-3.2-1.8-4.4s-2.7-1.8-4.4-1.8H383c-1.6 0-3.2.7-4.4 1.8s-1.8 2.7-1.8 4.4v1.7H318v-85.3h151.5zm8 0v-85.3h41l-6.2 85.3zM0 434.3a289 289 0 0 0 28.1 29l730.6 1a289 289 0 0 0 28.1-29z"></path><path d="M495.4 341.6v85.7c0 2.3 1.8 4 4 4h127c2.3 0 4-1.8 4-4v-85.7c0-2.3-1.8-4-4-4h-127c-2.3 0-4 1.8-4 4z"></path></g><path d="M498.4 342.7v83.6c0 1.2 1 2.2 2.2 2.2h125c1.2 0 2.2-1 2.2-2.2v-83.6c0-1.2-1-2.2-2.2-2.2h-125c-1.2 0-2.2 1-2.2 2.2z" fill="#6c63ff"></path><path d="M492.8 444c.5.6 1.2 1 2 1h136c.8 0 1.5-.3 2-1s.7-1.4.5-2l-2-10c-.2-.8-.8-1.5-1.6-1.8-.3-.1-.6-.2-1-.2H496.8c-.3 0-.6.1-1 .2-.8.3-1.4 1-1.6 1.8l-2 10c-.2.7 0 1.5.5 2z" fill="#2f2e41"></path><g fill="#3f3d56"><rect x="830" y="595.6" width="4.2" height="2.5" rx=".5" transform="matrix(-1 0 0 -1 1457.67 1029.82)"></rect><rect x="821.7" y="595.6" width="4.2" height="2.5" rx=".5" transform="matrix(-1 0 0 -1 1440.91 1029.82)"></rect><rect x="813.3" y="595.6" width="4.2" height="2.5" rx=".5" transform="matrix(-1 0 0 -1 1424.16 1029.82)"></rect><rect x="804.9" y="595.6" width="4.2" height="2.5" rx=".5" transform="matrix(-1 0 0 -1 1407.4 1029.82)"></rect><rect x="796.5" y="595.6" width="4.2" height="2.5" rx=".5" transform="matrix(-1 0 0 -1 1390.65 1029.82)"></rect><rect x="788.1" y="595.6" width="4.2" height="2.5" rx=".5" transform="matrix(-1 0 0 -1 1373.9 1029.82)"></rect><rect x="779.8" y="595.6" width="4.2" height="2.5" rx=".5" transform="matrix(-1 0 0 -1 1357.14 1029.82)"></rect><rect x="771.4" y="595.6" width="4.2" height="2.5" rx=".5" transform="matrix(-1 0 0 -1 1340.39 1029.82)"></rect><rect x="763" y="595.6" width="4.2" height="2.5" rx=".5" transform="matrix(-1 0 0 -1 1323.63 1029.82)"></rect><rect x="754.6" y="595.6" width="4.2" height="2.5" rx=".5" transform="matrix(-1 0 0 -1 1306.88 1029.82)"></rect><rect x="746.3" y="595.6" width="4.2" height="2.5" rx=".5" transform="matrix(-1 0 0 -1 1290.13 1029.82)"></rect><rect x="737.9" y="595.6" width="4.2" height="2.5" rx=".5" transform="matrix(-1 0 0 -1 1273.37 1029.82)"></rect><rect x="729.5" y="595.6" width="4.2" height="2.5" rx=".5" transform="matrix(-1 0 0 -1 1256.62 1029.82)"></rect><rect x="721.1" y="595.6" width="4.2" height="2.5" rx=".5" transform="matrix(-1 0 0 -1 1239.86 1029.82)"></rect><rect x="712.8" y="595.6" width="4.2" height="2.5" rx=".5" transform="matrix(-1 0 0 -1 1223.11 1029.82)"></rect><rect x="704.4" y="595.6" width="4.2" height="2.5" rx=".5" transform="matrix(-1 0 0 -1 1206.36 1029.82)"></rect><rect x="830.1" y="599.8" width="4.2" height="2.5" rx=".5" transform="matrix(-1 0 0 -1 1457.86 1038.2)"></rect><rect x="821.8" y="599.8" width="4.2" height="2.5" rx=".5" transform="matrix(-1 0 0 -1 1441.11 1038.2)"></rect><rect x="813.4" y="599.8" width="4.2" height="2.5" rx=".5" transform="matrix(-1 0 0 -1 1424.36 1038.2)"></rect><rect x="805" y="599.8" width="4.2" height="2.5" rx=".5" transform="matrix(-1 0 0 -1 1407.6 1038.2)"></rect><rect x="796.6" y="599.8" width="4.2" height="2.5" rx=".5" transform="matrix(-1 0 0 -1 1390.85 1038.2)"></rect><rect x="788.2" y="599.8" width="4.2" height="2.5" rx=".5" transform="matrix(-1 0 0 -1 1374.09 1038.2)"></rect><rect x="779.9" y="599.8" width="4.2" height="2.5" rx=".5" transform="matrix(-1 0 0 -1 1357.34 1038.2)"></rect><rect x="771.5" y="599.8" width="4.2" height="2.5" rx=".5" transform="matrix(-1 0 0 -1 1340.59 1038.2)"></rect><rect x="763.1" y="599.8" width="4.2" height="2.5" rx=".5" transform="matrix(-1 0 0 -1 1323.83 1038.2)"></rect><rect x="754.7" y="599.8" width="4.2" height="2.5" rx=".5" transform="matrix(-1 0 0 -1 1307.08 1038.2)"></rect><rect x="746.4" y="599.8" width="4.2" height="2.5" rx=".5" transform="matrix(-1 0 0 -1 1290.32 1038.2)"></rect><rect x="738" y="599.8" width="4.2" height="2.5" rx=".5" transform="matrix(-1 0 0 -1 1273.57 1038.2)"></rect><rect x="729.6" y="599.8" width="4.2" height="2.5" rx=".5" transform="matrix(-1 0 0 -1 1256.82 1038.2)"></rect><rect x="721.2" y="599.8" width="4.2" height="2.5" rx=".5" transform="matrix(-1 0 0 -1 1240.06 1038.2)"></rect><rect x="712.9" y="599.8" width="4.2" height="2.5" rx=".5" transform="matrix(-1 0 0 -1 1223.31 1038.2)"></rect><rect x="704.5" y="599.8" width="4.2" height="2.5" rx=".5" transform="matrix(-1 0 0 -1 1206.55 1038.2)"></rect><rect x="760.6" y="604.8" width="33.5" height="2.5" rx=".5" transform="matrix(-1 0 0 -1 1348.13 1048.25)"></rect></g><g fill="#fff"><rect x="515.6" y="358.7" width="6" height="3.1" rx="1.6"></rect><rect x="548.2" y="358.7" width="6" height="3.1" rx="1.6"></rect><rect x="557.4" y="358.7" width="6" height="3.1" rx="1.6"></rect><rect x="524.5" y="358.5" width="20.8" height="3.1" rx="1.6"></rect><rect x="567.8" y="358.5" width="20.8" height="3.1" rx="1.6"></rect><rect x="524.3" y="365.8" width="6" height="3.1" rx="1.6"></rect><rect x="556.8" y="365.8" width="6" height="3.1" rx="1.6"></rect><rect x="566" y="365.8" width="6" height="3.1" rx="1.6"></rect><rect x="533.2" y="365.5" width="20.8" height="3.1" rx="1.6"></rect><rect x="576.5" y="365.5" width="20.8" height="3.1" rx="1.6"></rect><rect x="533" y="372.8" width="6" height="3.1" rx="1.6"></rect><rect x="565.5" y="372.8" width="6" height="3.1" rx="1.6"></rect><rect x="574.7" y="372.8" width="6" height="3.1" rx="1.6"></rect><rect x="541.8" y="372.6" width="20.8" height="3.1" rx="1.6"></rect><rect x="585.2" y="372.6" width="20.8" height="3.1" rx="1.6"></rect><rect x="541.6" y="379.9" width="6" height="3.1" rx="1.6"></rect><rect x="574.2" y="379.9" width="6" height="3.1" rx="1.6"></rect><rect x="583.4" y="379.9" width="6" height="3.1" rx="1.6"></rect><rect x="550.5" y="379.6" width="20.8" height="3.1" rx="1.6"></rect><rect x="548.2" y="407.9" width="6" height="3.1" rx="1.6"></rect><rect x="557.4" y="407.9" width="6" height="3.1" rx="1.6"></rect><rect x="567.8" y="408.2" width="20.8" height="3.1" rx="1.6"></rect><rect x="515.6" y="407.9" width="6" height="3.1" rx="1.6"></rect><rect x="524.5" y="408.2" width="20.8" height="3.1" rx="1.6"></rect><rect x="524.3" y="400.9" width="6" height="3.1" rx="1.6"></rect><rect x="556.8" y="400.9" width="6" height="3.1" rx="1.6"></rect><rect x="566" y="400.9" width="6" height="3.1" rx="1.6"></rect><rect x="533.2" y="401.1" width="20.8" height="3.1" rx="1.6"></rect><rect x="533" y="393.8" width="6" height="3.1" rx="1.6"></rect><rect x="565.5" y="393.8" width="6" height="3.1" rx="1.6"></rect><rect x="574.7" y="393.8" width="6" height="3.1" rx="1.6"></rect><rect x="541.8" y="394.1" width="20.8" height="3.1" rx="1.6"></rect><rect x="541.6" y="386.8" width="6" height="3.1" rx="1.6"></rect><rect x="574.2" y="386.8" width="6" height="3.1" rx="1.6"></rect><rect x="583.4" y="386.8" width="6" height="3.1" rx="1.6"></rect><rect x="550.5" y="387" width="20.8" height="3.1" rx="1.6"></rect></g><path d="M505 490.5l-13.3-21 42-33.4 17.3-19.2c4.6-5 11.5-7.3 18.2-6s12 6.3 14.2 12.7h0c3.2 9.8-2 20.4-11.6 24l-27.3 10z" fill="#ffb6b6"></path><path d="M191.7 337.5V440h72V337.5c0-1.5-1-3-2.4-3.3-.3-.1-.7-.2-1-.2h-65c-1 0-1.8.4-2.5 1s-1 1.5-1 2.4zm28 35.2c0-4.2 3.5-7.6 7.7-7.6s7.6 3.4 7.7 7.6v12c0 4.2-3.4 7.6-7.7 7.6s-7.6-3.4-7.7-7.6z" fill="#2f2e41"></path><path d="M191.5 436.8v10c0 1 1 2 2 2H262c1 0 2-1 2-2v-10zM78.7 183v187.3a9 9 0 0 0 9 9h277.5a9 9 0 0 0 9-9V183a9 9 0 0 0-9-9H87.7a9 9 0 0 0-9 9z" fill="#3f3d56"></path><path d="M85.2 185.3V368c0 2.7 2.2 4.8 4.8 4.8h273c2.7 0 4.8-2.2 4.8-4.8V185.3c0-2.7-2.2-4.8-4.8-4.8H90c-2.7 0-4.8 2.2-4.8 4.8z" fill="#fff"></path><path d="M135.8 448c.6.7 1.4 1 2.3 1h162.3a3 3 0 0 0 2.9-3.6l-2.5-12a3 3 0 0 0-1.9-2.2c-.3-.1-.7-.2-1-.2H140.6c-.4 0-.7.1-1 .2a3 3 0 0 0-1.9 2.2l-2.5 12a3 3 0 0 0 .6 2.5z" fill="#2f2e41"></path><g fill="#3f3d56"><path d="M354 205.6H98.7c-.6 0-1-.5-1-1s.4-1 1-1H354c.6 0 1 .5 1 1s-.4 1-1 1z"></path><ellipse cx="116.1" cy="192.3" rx="6" ry="6.1"></ellipse><ellipse cx="136.6" cy="192.3" rx="6" ry="6.1"></ellipse><ellipse cx="157.2" cy="192.3" rx="6" ry="6.1"></ellipse><use xlink:href="#B"></use><use xlink:href="#B" y="4.2"></use><use xlink:href="#B" y="8.2"></use></g><path d="M693.6 441c1 2.6 3.4 4.4 6.2 4.3l26.5-.7c2.8-.1 5.2-2 6-4.7l3.7-40c1.3.6 2.8 1 4.2 1 5.3-.1 9.5-4.6 9.4-10s-4.6-9.5-10-9.4c-.6 0-1.2.1-1.7.2-1.3-1.4-3-2-5-2l-40.8 1c-.3 0-.7.1-1 .1-1.8.3-3.4 1.4-4.3 3s-1 3.5-.6 5.2zm43.2-43.8l2.7-9.6c.3-1 .3-2.3 0-3.4.1 0 .2-.1.4-.1 3.8-.1 7 3 7 6.7s-3 7-6.7 7c-1.2 0-2.4-.2-3.4-.8z" fill="#2f2e41"></path><path d="M691.4 380.8c1 5 10.6 8.5 22.4 7.8 10.8-.5 19.6-4.3 21.2-8.8a6 6 0 0 0-1.8-.2l-40.8 1c-.3 0-.7.1-1 .1z" fill="#3f3d56"></path><g fill="#6c63ff"><path d="M716 419c.1 0 .1 0 .2-.1l5.8-3.8c.1-.1.2-.2.2-.4s-.1-.3-.2-.4l-6-4c-.1-.1-.3-.1-.5 0s-.3.2-.3.4.1.3.2.4l5.3 3.5-5 3.3c-.2.1-.3.4-.2.6s.3.3.6.3zm-9.2.5c.2-.1.3-.2.4-.4s-.1-.4-.2-.5l-5.3-3 5-3.8c.1-.1.2-.3.2-.5s-.1-.3-.3-.4-.4 0-.5.1l-5.7 4.3c-.1.1-.2.3-.2.4s.1.3.3.4l6 3.4c.1.1.2.1.4.1zm8.5 3s.1 0 .1-.1c.1-.1.2-.2.2-.3s0-.3-.1-.4l-8.2-13.4c-.1-.2-.5-.3-.7-.2s-.3.5-.2.7l8.2 13.4c.1.2.3.3.5.2z"></path><rect x="209.4" y="260.8" width="50.7" height="10.8" rx="3.3"></rect></g><g fill="#e6e6e6"><rect x="183.6" y="282.5" width="102.2" height="10.8" rx="3.3"></rect><rect x="183.6" y="304.2" width="102.2" height="10.8" rx="3.3"></rect></g><g fill="#3f3d56"><path d="M290.7 376.8l.2.7h0l6.5 19.8 7.5 23 14 43 .1 6.7h0l1 53.7-3 7.3 3.3 12s-1.5-18-9.6-7.7c-4.6 6-10 12-14.3 17.6q9.6 4 19.5 7l4.3 1.3q.5.1 1 .3a267 267 0 0 0 67.4 10.8l3.5.1h1.2 3.8q4 0 7.7-.1a267 267 0 0 0 56.1-7.6l-1-26c-.2-4.6-5.4-9.7-5.7-14.5-.2-3.7 4.4-7 4-10.8-1.6-22.8-3.5-14-5-30.2q-.2-2.4-.4-4.6l-1.6-17 6-38.7 9.6-60.7-.7-1.2-.8-.4-50.8-25.2-2.8-7a11 11 0 0 0-10.1-6.9l-33.5-.1c-3.5 0-6.8 1.7-9 4.5l-9 12.6z"></path><path d="M326.8 453.7l-7.6 16.2-5.2 11-9 46.6-4.5 4.7-3.8-16.8-40 9c-1.3-7.3-.4.2-1.2-7.8l.7-.7c.6-.6 1.2-1.2 1.2-1.7-.5-27.6 1-74.5 12.3-103a60 60 0 0 1 7-13.1l.7-1 13.3-19.8h0l.1-.1 32.4-17.2 1.4 39 1 28zm117 4.6l9.5 20.3 3.3 7 9 46.6 4.4 4.7 3.8-16.8 1.8-.4L508 513l9.5 30a18 18 0 0 0-3.3-22.5c-.6-.6-1.2-1.2-1.2-1.7.5-32.4-1.4-91.7-19.4-116-5.7-7.7-9-15.4-14-20.8l-12-19.8-.7-1.2-.8-.4z"></path></g><circle cx="386.4" cy="267.2" r="44.6" fill="#ffb6b6"></circle><path d="M446.6 236c-.7-.7-1.7-1.2-2.7-1.2l.7-2c.4-1.2.2-2.5-.6-3.5s-2-1.4-3.4-1.2l-2.4.5.2-1.6c.2-1.2-.3-2.5-1.3-3.3s-2.3-1-3.5-.6c-1 .4-2.3.3-3.2-.2-1-.5-1.7-1.5-2-2.6l-1-4-.1-.2c-4-7-12-12-21.8-13.8-8.7-1.6-17.6-.8-26 0-3.4.3-7.2.7-10.4 2.6-2.7 1.7-5 5-4.5 8.4-8.5-2.6-17.5 2.6-22 9-5.3 7.8-6.2 17.5-6.3 25-.4 18 3.3 32.7 11 43.7.6.8.7 2.5 1.8 3v-.4c1.2.6 2.5 1.6 2 2.7-1.4 3 7.6 10 14 12a88 88 0 0 0 37.6 2.3l.4-2.6c4-.5 6.6-1.5 7.4-3l3.5-3.2h0v-.1c5-4.7 6-7.3 6.5-11.4.5-4-.4-8-1.3-11.6 18.7 3-7.4-20 10-24.4.2-.1.4-.1.6-.1l1.5-.4c2.4-.6 4.6-1.6 6.7-3 5-3 6.5-7 9-11.4.7-1.3.6-3-.4-4zM544 461.4v7.2q0 .6 0 1.3l-.5 15.4v1l-1.5 29c-1.4 24.7-4 3.4-6.3 12l-.4 1.5a28 28 0 0 1-1.9 6.3l-4 2.3a281 281 0 0 1-11.5 6.1l-6.6 3.2-1 .5a271 271 0 0 1-34.7 13.3 241 241 0 0 1-7 2l-7.4 2a267 267 0 0 1-56.1 7.6l-7.7.1h-3.8-1.2l-3.5-.1a270 270 0 0 1-67.4-10.8l-1-.3-4.3-1.3q-10-3-19.5-7-7.3-3-14.5-6.3s-.1 0-.1-.1l-3-1.4c-.1-.1-.3-.1-.4-.2q-5.6-2.7-11-5.7c-3-7-7.4-8.4-10-14.6a26 26 0 0 1-1.7-5.7v-.1c.3 3.7-1.2-6.6 0 0v-.4-1.4c-3.4-33.5-3.2-71.8-4.7-103.4q-.2-3-.3-6l-.1-1.8.2-.5a1 1 0 0 1 .1-.1l.1-.2v-.1s0-.1.1-.1l.3-.4.1-.2c0-.1.1-.1.1-.1l.1-.1v-.1s0-.1.1-.1c.1-.1.2-.2.3-.2l1-1 .4-.3c1-.6 2-1 3.2-1.5.4-.1.8-.3 1.2-.4l.4-.1h.7c1-.3 2.4-.6 3.7-1l.5-.1.7-.1 1-.2c3-.5 6.3-.8 10-1q.5 0 1-.1h1.2 1 1l3-.1h9.5l4.8.1h.3l4.3.2c1 0 2 .1 3 .2l3 .2h2.3 2l1 .1 1.5.1 3.3.3 3.4.3 3.4.3h.3l3 .3.7.1 3 .3h1l2.4.3 3.2.4 2.4.3 4 .5 1.5.2L357 403a869 869 0 0 1 17.4 2.6q8.8 1.4 17.7 3l4.5.8q1 .2 2 .4l3.5.6 3.5.7 4 .8 27 5.7 4.3 1q4.3 1 8.6 2l2.3.6 5.7 1.5h.3a224 224 0 0 1 4.1 1q4.8 1.3 9.5 2.5 3 1 6 1.7l8.8 2.6 2 .6 6.2 2 4.7 1.6q2.3.8 4.5 1.6l2.8 1 4 1.5 1.2.5.7.3 1.4.6 1.4.6 1.4.6 1.3.6 1 .5 2 1 1 .5.8.4.3.2c.3.1.5.3.8.4.6.3 1 .6 1.7.8l2.2 1 2 1h.3l.5.3 1.5 1 2.7 1.8.6.4 1.8 1.3c.2.1.4.3.6.4.1.1.3.3.5.4l1.4 1.3.4.4c.1 0 .1.1.2.2l.6.6s0 .1.1.1l.7.8c.1.1.2.3.3.4l.3.5.3.4.5 1 .3.8c.1.3.1.5.2.8z" fill="#2f2e41"></path><path d="M544 461.4v7.2 1.3l-.5 15.4v1l-1.5 29c-1.4 24.7-4 3.4-6.3 12L513 514.3q-2.2-1.2-4.4-2.5c-16-9-34-18.4-52.8-27.7l-2.2-1L326 427.4l-21-7.2c-14-4.4-25.8-7.5-35-9-9.6-1.4-16.2-1-19 2q-.2-3-.3-6-.1-1-.1-1.8c.1-.2.1-.3.2-.5 0 0 0 0 0-.1a1 1 0 0 1 .1-.1l.1-.2c0-.1.1-.1.1-.2l.3-.4.3-.3c0 0 .1-.1.1-.1l.1-.1c0 0 0-.1.1-.1.1-.1.2-.2.3-.2l1-1 .4-.3c1-.6 2-1 3.2-1.5.4-.1.8-.3 1.2-.4l.4-.1.7-.2c1-.3 2.4-.6 3.7-1l1.2-.2 1-.2c3-.5 6.3-.8 10-1q.5 0 1-.1h1.2c.4 0 .7 0 1 0 .4 0 .7 0 1 0l3-.1h9.5l4.8.1h.3l4.3.2c1 0 2 .1 3 .2l3 .2h2.3l2 .1 2.4.2 3.3.3 3.4.3 3.4.3h.3l3 .3q8.7 1 18 2 5.5.7 11.2 1.5l17.4 2.6q8.8 1.4 17.7 3l4.5.8q2.8.5 5.5 1l3.5.7 4 .8 27 5.7 4.3 1q4.3 1 8.6 2l2.3.6q3 .7 5.7 1.4h0 .3a409 409 0 0 1 4.1 1.1q4.8 1.3 9.5 2.5l6 1.7 8.8 2.6 2 .6q3 1 6.2 2l4.7 1.6q2.3.8 4.5 1.6l2.8 1 4 1.5 1.2.5 2 1 1.4.6 1.3.6 1.3.6 1 .5 2 1 1 .5.8.4.3.2a115 115 0 0 1 2.5 1.2l2.2 1 2.4 1.3.5.3 1.5 1 2.7 1.8 2.4 1.7 1 .8 1.4 1.3c.1.1.3.3.4.4.1 0 .1.1.2.2l.6.7.7.8c.1.1.2.3.3.4l.3.5.3.4c.2.4.4.7.5 1 .1.3.2.5.3.8.1.3.1.5.2.8z" opacity=".2"></path><defs><path id="B" d="M341.6 187.8H327c-.6 0-1 .5-1 1s.5 1 1 1h14.6c.6 0 1-.5 1-1s-.5-1-1-1z"></path></defs></svg></div>
		<div class="metadata-text"><p style="display: flex; margin: 0; align-self: end;"><span style="font-weight: 600;">By Duaibeom</span>
				<span style="color: #57606a; margin-left: auto;">Jan. 31, 2023</span></p>
			<ul class="tag" style="justify-self: end; align-self: start;"><li>validation</li><li>ML</li></ul></div></div>
	

	<div class="base-grid"><div class="grid-toc"><div class="toc"><!-- HTML_TAG_START --><h4>Contents</h4><p class="toc-h2"><a href="#stratified-group-k-fold">Stratified Group K-Fold</a></p><p class="toc-h3"><a href="#original-code-with-explanation">Original code with explanation</a></p><p class="toc-h3"><a href="#summary-with-metaphor">Summary with metaphor</a></p><p class="toc-h3"><a href="#optimized-code-with-numpy-and-pandas">Optimized code with numpy and pandas</a></p><p class="toc-h3"><a href="#check-distributions-of-splited-data">Check distributions of splited data</a></p><p class="toc-h3"><a href="#optimized-code-with-numpy-and-polars">Optimized code with numpy and polars</a></p><!-- HTML_TAG_END --></div></div>
		

		<div class="grid-article"><!-- HTML_TAG_START --><h2 id="stratified-group-k-fold">Stratified Group K-Fold<a href="#stratified-group-k-fold" class="anchor"><span class="visually-hidden">#</span></a></h2><p>Original Code: <a href="https://www.kaggle.com/jakubwasikowski/stratified-group-k-fold-cross-validation">jakubwasikowski’s code</a></p>
<h3 id="original-code-with-explanation">Original code with explanation<a href="#original-code-with-explanation" class="anchor"><span class="visually-hidden">#</span></a></h3><div class="code-block python"><pre class='language-python'><code><span class="token comment"># %%timeit</span>
<span class="token comment"># 7.23 s ± 141 ms per loop (mean ± std. dev. of 7 runs, 1 loop each)</span>

labels_num <span class="token operator">=</span> np<span class="token punctuation">.</span><span class="token builtin">max</span><span class="token punctuation">(</span>y<span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token number">1</span>  <span class="token comment"># label이 0~9로 구성이 되어 있어 최대 값에 1을 더해 label 개수를 파악합니다.</span>
<span class="token comment"># 각 image 별로 label 개수를 확인하기 위해 지정합니다.</span>
y_counts_per_group <span class="token operator">=</span> defaultdict<span class="token punctuation">(</span><span class="token keyword">lambda</span><span class="token punctuation">:</span> np<span class="token punctuation">.</span>zeros<span class="token punctuation">(</span>labels_num<span class="token punctuation">)</span><span class="token punctuation">)</span>  <span class="token comment"># dict shape: (n_image, n_label)</span>
<span class="token comment"># 각 label 별 개수를 확인하기 위해 지정합니다.</span>
y_distr <span class="token operator">=</span> Counter<span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token comment"># annotation 데이터를 이용해 순차적으로 데이터를 확인합니다.</span>
<span class="token keyword">for</span> label<span class="token punctuation">,</span> g <span class="token keyword">in</span> <span class="token builtin">zip</span><span class="token punctuation">(</span>y<span class="token punctuation">,</span> groups<span class="token punctuation">)</span><span class="token punctuation">:</span>
    y_counts_per_group<span class="token punctuation">[</span>g<span class="token punctuation">]</span><span class="token punctuation">[</span>label<span class="token punctuation">]</span> <span class="token operator">+=</span> <span class="token number">1</span>
    y_distr<span class="token punctuation">[</span>label<span class="token punctuation">]</span> <span class="token operator">+=</span> <span class="token number">1</span>

y_counts_per_fold <span class="token operator">=</span> defaultdict<span class="token punctuation">(</span><span class="token keyword">lambda</span><span class="token punctuation">:</span> np<span class="token punctuation">.</span>zeros<span class="token punctuation">(</span>labels_num<span class="token punctuation">)</span><span class="token punctuation">)</span>  <span class="token comment"># fold별 각 label 개수를 파악하기 위해 지정합니다.</span>

<span class="token comment"># 어떤 image가 특정 fold에 속할 때 전체 fold의 std 값 확인하는 함수입니다.</span>
<span class="token keyword">def</span> <span class="token function">eval_y_counts_per_fold</span><span class="token punctuation">(</span>y_counts<span class="token punctuation">,</span> fold<span class="token punctuation">)</span><span class="token punctuation">:</span>
    y_counts_per_fold<span class="token punctuation">[</span>fold<span class="token punctuation">]</span> <span class="token operator">+=</span> y_counts  <span class="token comment"># image가 특정 fold에 속한 것을 반영합니다.</span>
    std_per_label <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>
    <span class="token comment"># label 별로 전체 fold에 대해 std 값을 확인합니다.</span>
    <span class="token keyword">for</span> label <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span>labels_num<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token comment"># label 별로 개수가 다르기 때문에 scale을 맞추기 위해 각 label 별 총 개수로 나누어 줍니다.</span>
        label_std <span class="token operator">=</span> np<span class="token punctuation">.</span>std<span class="token punctuation">(</span><span class="token punctuation">[</span>y_counts_per_fold<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span>label<span class="token punctuation">]</span> <span class="token operator">/</span> y_distr<span class="token punctuation">[</span>label<span class="token punctuation">]</span> <span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span>k<span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
        std_per_label<span class="token punctuation">.</span>append<span class="token punctuation">(</span>label_std<span class="token punctuation">)</span>
    <span class="token comment"># 본 함수는 해당 image가 특정 fold에 속한 것을 가정하고 계산합니다. 해당 image가 특정 fold에 속하지 않을 수 있기 때문에 원상 복구 합니다.</span>
    y_counts_per_fold<span class="token punctuation">[</span>fold<span class="token punctuation">]</span> <span class="token operator">-=</span> y_counts
    <span class="token comment"># label별 std를 평균냅니다.</span>
    <span class="token keyword">return</span> np<span class="token punctuation">.</span>mean<span class="token punctuation">(</span>std_per_label<span class="token punctuation">)</span>

<span class="token comment"># image당 각 label 개수에 대한 값들만 활용합니다.</span>
groups_and_y_counts <span class="token operator">=</span> <span class="token builtin">list</span><span class="token punctuation">(</span>y_counts_per_group<span class="token punctuation">.</span>items<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token comment"># shuffle 후 sort 하는 것이 이상해 보이지만, sort 하였을 때 같은 std 값일 경우 순서가 달라지게 됩니다.</span>
random<span class="token punctuation">.</span>Random<span class="token punctuation">(</span>seed<span class="token punctuation">)</span><span class="token punctuation">.</span>shuffle<span class="token punctuation">(</span>groups_and_y_counts<span class="token punctuation">)</span>
groups_per_fold <span class="token operator">=</span> defaultdict<span class="token punctuation">(</span><span class="token builtin">set</span><span class="token punctuation">)</span>  <span class="token comment"># 각 fold별 index를 저장하기 위해 지정합니다.</span>

<span class="token comment"># 큰 std를 가진 image부터 순차적으로 best fold를 찾습니다.</span>
<span class="token keyword">for</span> g<span class="token punctuation">,</span> y_counts <span class="token keyword">in</span> <span class="token builtin">sorted</span><span class="token punctuation">(</span>groups_and_y_counts<span class="token punctuation">,</span> key<span class="token operator">=</span><span class="token keyword">lambda</span> x<span class="token punctuation">:</span> <span class="token operator">-</span>np<span class="token punctuation">.</span>std<span class="token punctuation">(</span>x<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    best_fold <span class="token operator">=</span> <span class="token boolean">None</span>
    min_eval <span class="token operator">=</span> <span class="token boolean">None</span>
    <span class="token comment"># image가 어떤 fold에 속할 때 가장 낮은 std를 가지는지 확인하는 과정입니다.</span>
    <span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span>k<span class="token punctuation">)</span><span class="token punctuation">:</span>  <span class="token comment"># 각 fold에 대해 순차적으로 확인합니다.</span>
        fold_eval <span class="token operator">=</span> eval_y_counts_per_fold<span class="token punctuation">(</span>y_counts<span class="token punctuation">,</span> i<span class="token punctuation">)</span>  <span class="token comment"># 전체 fold에 대해 std값 확인.</span>
        <span class="token comment"># std 값이 가장 낮을 때가 best fold 입니다.</span>
        <span class="token keyword">if</span> min_eval <span class="token keyword">is</span> <span class="token boolean">None</span> <span class="token keyword">or</span> fold_eval <span class="token operator">&lt;</span> min_eval<span class="token punctuation">:</span>
            min_eval <span class="token operator">=</span> fold_eval
            best_fold <span class="token operator">=</span> i
    y_counts_per_fold<span class="token punctuation">[</span>best_fold<span class="token punctuation">]</span> <span class="token operator">+=</span> y_counts  <span class="token comment"># best fold를 확정하고 해당 image를 반영합니다.</span>
    groups_per_fold<span class="token punctuation">[</span>best_fold<span class="token punctuation">]</span><span class="token punctuation">.</span>add<span class="token punctuation">(</span>g<span class="token punctuation">)</span>  <span class="token comment"># best fold에 해당 이미지의 index를 추가합니다.</span></code></pre></div><h3 id="summary-with-metaphor">Summary with metaphor<a href="#summary-with-metaphor" class="anchor"><span class="visually-hidden">#</span></a></h3><p>다양한 크기의 감자(image)를 수확했습니다. (갑자기?) 우리는 이것을 5개 상자(fold)에 나누어 담아야 합니다.</p>
<p>하지만! 5개의 상자에 다양한 크기의 감자들이 골고루 담겨야 하며, 5개 상자 무게 모두 동일해야 합니다. (예?!)</p>
<p>다양한 크기의 감자를 상자에 넣기 위해서는 큰 감자는 가장 먼저 넣는게 좋을 것 같네요.</p>
<p>큰 감자는 나중에 넣게 되면 쉽게 넘칠 수 있고 무게 또한 많이 달라지기 때문에 가장 먼저 넣는게 좋을 것 같습니다. 정리를 할 때도 큰 것을 먼저 배치하면 좋다고 하니까요..</p>
<p>큰 감자부터 순서대로 차곡차곡 상자에 담습니다. 중간 중간 무게도 확인하면서요.</p>
<p>그 결과 상자별 감자 개수는 다를지 몰라도 다양한 크기를 가진 감자들이 균일하게 담긴 것 같네요.</p>
<p><img src="https://s3-us-west-2.amazonaws.com/aistages-prod-server-public/app/Users/00000526/files/54c3f53b-8534-49f9-a594-d6aeffae568f..png" alt="https://s3-us-west-2.amazonaws.com/aistages-prod-server-public/app/Users/00000526/files/54c3f53b-8534-49f9-a594-d6aeffae568f..png"></p>
<p>그렇군요. 감자하게도 잘 된 것 같네요. :ㅇ</p>
<p>(정확한 설명은 아니지만 이런 뉘앙스를 가진다 이해해주시면 감사하겠습니다.)</p>
<p>마지막으로 좀 더 선별을 잘 하기 위해 최신 저울(pandas, numpy)을 도입하기로 했습니다.</p>
<h3 id="optimized-code-with-numpy-and-pandas">Optimized code with numpy and pandas<a href="#optimized-code-with-numpy-and-pandas" class="anchor"><span class="visually-hidden">#</span></a></h3><div class="code-block python"><pre class='language-python'><code><span class="token comment"># %%timeit</span>
<span class="token comment"># 838 ms ± 28.1 ms per loop (mean ± std. dev. of 7 runs, 1 loop each)</span>

labels_num <span class="token operator">=</span> y<span class="token punctuation">.</span><span class="token builtin">max</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token number">1</span>
<span class="token comment"># https://stackoverflow.com/a/39132900/14019325</span>
<span class="token comment"># 기존 코드의 첫번째 loop와 동일합니다. 각 image 별 label 개수를 확인합니다.</span>
y_counts_per_group <span class="token operator">=</span> df<span class="token punctuation">.</span>groupby<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token string">'image_id'</span><span class="token punctuation">,</span> <span class="token string">'category_id'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">.</span>size<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>unstack<span class="token punctuation">(</span>fill_value<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">)</span>
y_counts_per_fold <span class="token operator">=</span> np<span class="token punctuation">.</span>zeros<span class="token punctuation">(</span><span class="token punctuation">(</span>k<span class="token punctuation">,</span> labels_num<span class="token punctuation">)</span><span class="token punctuation">)</span>

<span class="token comment"># scale을 미리 계산하여 연산을 줄입니다.</span>
y_norm_counts_per_group <span class="token operator">=</span> y_counts_per_group <span class="token operator">/</span> y_counts_per_group<span class="token punctuation">.</span><span class="token builtin">sum</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token comment"># suffle &amp; sort</span>
shuffled_and_sorted_index <span class="token operator">=</span> y_norm_counts_per_group<span class="token punctuation">.</span>sample<span class="token punctuation">(</span>frac<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">,</span> random_state<span class="token operator">=</span>seed<span class="token punctuation">)</span><span class="token punctuation">.</span>std<span class="token punctuation">(</span>axis<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">.</span>sort_values<span class="token punctuation">(</span>ascending<span class="token operator">=</span><span class="token boolean">False</span><span class="token punctuation">)</span><span class="token punctuation">.</span>index
y_norm_counts_per_group <span class="token operator">=</span> y_norm_counts_per_group<span class="token punctuation">.</span>loc<span class="token punctuation">[</span>shuffled_and_sorted_index<span class="token punctuation">]</span>

groups_per_fold <span class="token operator">=</span> defaultdict<span class="token punctuation">(</span><span class="token builtin">set</span><span class="token punctuation">)</span>

<span class="token keyword">for</span> g<span class="token punctuation">,</span> y_counts <span class="token keyword">in</span> <span class="token builtin">zip</span><span class="token punctuation">(</span>y_norm_counts_per_group<span class="token punctuation">.</span>index<span class="token punctuation">,</span> y_norm_counts_per_group<span class="token punctuation">.</span>values<span class="token punctuation">)</span><span class="token punctuation">:</span>
    best_fold <span class="token operator">=</span> <span class="token boolean">None</span>
    min_eval <span class="token operator">=</span> <span class="token boolean">None</span>
    <span class="token keyword">for</span> fold_i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span>k<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token comment"># 기존 코드 eval_y_counts_per_fold 와 동일합니다.</span>
        y_counts_per_fold<span class="token punctuation">[</span>fold_i<span class="token punctuation">]</span> <span class="token operator">+=</span> y_counts
        fold_eval <span class="token operator">=</span> y_counts_per_fold<span class="token punctuation">.</span>std<span class="token punctuation">(</span>axis<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">.</span>mean<span class="token punctuation">(</span><span class="token punctuation">)</span>  <span class="token comment"># numpy를 활용하여 연산을 단순화 합니다.</span>
        <span class="token comment"># `.std(axis=0)` 각 label 별 std 계산 후 평균</span>
        y_counts_per_fold<span class="token punctuation">[</span>fold_i<span class="token punctuation">]</span> <span class="token operator">-=</span> y_counts
        <span class="token keyword">if</span> min_eval <span class="token keyword">is</span> <span class="token boolean">None</span> <span class="token keyword">or</span> fold_eval <span class="token operator">&lt;</span> min_eval<span class="token punctuation">:</span>
            min_eval <span class="token operator">=</span> fold_eval
            best_fold <span class="token operator">=</span> fold_i
    y_counts_per_fold<span class="token punctuation">[</span>best_fold<span class="token punctuation">]</span> <span class="token operator">+=</span> y_counts
    groups_per_fold<span class="token punctuation">[</span>best_fold<span class="token punctuation">]</span><span class="token punctuation">.</span>add<span class="token punctuation">(</span>g<span class="token punctuation">)</span></code></pre></div><p>최신 저울을 추가했더니 속도가 확실히 빨라졌네요. 7.23s –&gt; 0.84s 로 개선이 됐습니다.</p>
<p>pandas와 numpy를 활용해 loop 수를 최소화 하여 간략화 한것이 도움이 됐습니다.</p>
<h3 id="check-distributions-of-splited-data">Check distributions of splited data<a href="#check-distributions-of-splited-data" class="anchor"><span class="visually-hidden">#</span></a></h3><div class="code-block python"><pre class='language-python'><code><span class="token keyword">def</span> <span class="token function">get_distribution</span><span class="token punctuation">(</span>y_vals<span class="token punctuation">)</span><span class="token punctuation">:</span>
        y_distr <span class="token operator">=</span> Counter<span class="token punctuation">(</span>y_vals<span class="token punctuation">)</span>
        y_vals_sum <span class="token operator">=</span> <span class="token builtin">sum</span><span class="token punctuation">(</span>y_distr<span class="token punctuation">.</span>values<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
        <span class="token keyword">return</span> <span class="token punctuation">[</span><span class="token string-interpolation"><span class="token string">f'</span><span class="token interpolation"><span class="token punctuation">{</span>y_distr<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">/</span> y_vals_sum<span class="token punctuation">:</span><span class="token format-spec">.2%</span><span class="token punctuation">}</span></span><span class="token string">'</span></span> <span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span>np<span class="token punctuation">.</span><span class="token builtin">max</span><span class="token punctuation">(</span>y_vals<span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">]</span>

all_groups <span class="token operator">=</span> <span class="token builtin">set</span><span class="token punctuation">(</span>groups<span class="token punctuation">)</span>

distrs <span class="token operator">=</span> <span class="token punctuation">[</span>get_distribution<span class="token punctuation">(</span>y<span class="token punctuation">)</span><span class="token punctuation">]</span>
index <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">'training set'</span><span class="token punctuation">]</span>

<span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span>k<span class="token punctuation">)</span><span class="token punctuation">:</span>
    train_groups <span class="token operator">=</span> all_groups <span class="token operator">-</span> groups_per_fold<span class="token punctuation">[</span>i<span class="token punctuation">]</span>
    test_groups <span class="token operator">=</span> groups_per_fold<span class="token punctuation">[</span>i<span class="token punctuation">]</span>

    train_df <span class="token operator">=</span> df<span class="token punctuation">.</span>loc<span class="token punctuation">[</span>df<span class="token punctuation">[</span><span class="token string">'image_id'</span><span class="token punctuation">]</span><span class="token punctuation">.</span>isin<span class="token punctuation">(</span>train_groups<span class="token punctuation">)</span><span class="token punctuation">]</span>
    valid_df <span class="token operator">=</span> df<span class="token punctuation">.</span>loc<span class="token punctuation">[</span>df<span class="token punctuation">[</span><span class="token string">'image_id'</span><span class="token punctuation">]</span><span class="token punctuation">.</span>isin<span class="token punctuation">(</span>test_groups<span class="token punctuation">)</span><span class="token punctuation">]</span>

    distrs<span class="token punctuation">.</span>append<span class="token punctuation">(</span>get_distribution<span class="token punctuation">(</span>train_df<span class="token punctuation">[</span><span class="token string">'category_id'</span><span class="token punctuation">]</span><span class="token punctuation">.</span>values<span class="token punctuation">)</span><span class="token punctuation">)</span>
    index<span class="token punctuation">.</span>append<span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f'train set - fold </span><span class="token interpolation"><span class="token punctuation">{</span>i <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">}</span></span><span class="token string">'</span></span><span class="token punctuation">)</span>
    distrs<span class="token punctuation">.</span>append<span class="token punctuation">(</span>get_distribution<span class="token punctuation">(</span>valid_df<span class="token punctuation">[</span><span class="token string">'category_id'</span><span class="token punctuation">]</span><span class="token punctuation">.</span>values<span class="token punctuation">)</span><span class="token punctuation">)</span>
    index<span class="token punctuation">.</span>append<span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f'validation set - fold </span><span class="token interpolation"><span class="token punctuation">{</span>i <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">}</span></span><span class="token string">'</span></span><span class="token punctuation">)</span>

<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'Distribution per class:'</span><span class="token punctuation">)</span>
pd<span class="token punctuation">.</span>DataFrame<span class="token punctuation">(</span>distrs<span class="token punctuation">,</span> index<span class="token operator">=</span>index<span class="token punctuation">,</span> columns<span class="token operator">=</span><span class="token punctuation">[</span><span class="token string-interpolation"><span class="token string">f'Label </span><span class="token interpolation"><span class="token punctuation">{</span>l<span class="token punctuation">}</span></span><span class="token string">'</span></span> <span class="token keyword">for</span> l <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span>np<span class="token punctuation">.</span><span class="token builtin">max</span><span class="token punctuation">(</span>y<span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">)</span></code></pre></div><h3 id="optimized-code-with-numpy-and-polars">Optimized code with numpy and polars<a href="#optimized-code-with-numpy-and-polars" class="anchor"><span class="visually-hidden">#</span></a></h3><p>Not yet implemented.</p>
<!-- HTML_TAG_END --></div>
		</div>

	<div class="controls svelte-1wai065"><ul class="svelte-1wai065"><li class="prev svelte-1wai065"><span class="svelte-1wai065">previous</span>
			<a href="/ml/weights_of_layers">Weights of Layers</a></li>

		<li class="next svelte-1wai065"><span class="svelte-1wai065">next</span>
			<a href="/ml/image_processing">Image Processing</a></li></ul>
</div>

	<script src="https://giscus.app/client.js" data-repo="duaibeom/duaibeom.github.io" data-repo-id="R_kgDOGXam8A" data-category="General" data-category-id="DIC_kwDOGXam8M4COJSN" data-mapping="pathname" data-reactions-enabled="1" data-emit-metadata="0" data-input-position="bottom" data-theme="light" data-lang="en" crossorigin="anonymous" async></script></div>

	<footer><ul><li style="color: white;">© 2019 - 2023 Duaibeom Blog.</li>
		<li style="color: grey;">Powered by Svelte-kit(static) &amp; GitHub Pages</li></ul>
	<ul style="margin-left: auto;"><li><a href="/" style="color: #959da5;"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 19 19" class="d-block" height="20"><path d="M3.94 2A2 2 0 1 1 2 0a2 2 0 0 1 1.94 2zM4 5.48H0V18h4zm6.32 0H6.34V18h3.94v-6.57c0-3.66 4.77-4 4.77 0V18H19v-7.93c0-6.17-7.06-5.94-8.72-2.91z" fill="currentColor"></path></svg></a></li>
		<li><a href="https://github.com/duaibeom" style="color: #959da5;"><svg height="20" viewBox="0 0 16 16" version="1.1" aria-hidden="true"><path fill-rule="evenodd" d="M8 0C3.58 0 0 3.58 0 8c0 3.54 2.29 6.53 5.47 7.59.4.07.55-.17.55-.38 0-.19-.01-.82-.01-1.49-2.01.37-2.53-.49-2.69-.94-.09-.23-.48-.94-.82-1.13-.28-.15-.68-.52-.01-.53.63-.01 1.08.58 1.23.82.72 1.21 1.87.87 2.33.66.07-.52.28-.87.51-1.07-1.78-.2-3.64-.89-3.64-3.95 0-.87.31-1.59.82-2.15-.08-.2-.36-1.02.08-2.12 0 0 .67-.21 2.2.82.64-.18 1.32-.27 2-.27.68 0 1.36.09 2 .27 1.53-1.04 2.2-.82 2.2-.82.44 1.1.16 1.92.08 2.12.51.56.82 1.27.82 2.15 0 3.07-1.87 3.75-3.65 3.95.29.25.54.73.54 1.48 0 1.07-.01 1.93-.01 2.2 0 .21.15.46.55.38A8.013 8.013 0 0016 8c0-4.42-3.58-8-8-8z" fill="currentColor"></path></svg></a></li></ul></footer></body>


			
			<script>
				{
					__sveltekit_1kwx0yh = {
						env: {},
						base: new URL("..", location).pathname.slice(0, -1),
						element: document.currentScript.parentElement
					};

					const data = [null,{"type":"data","data":{prev:{slug:"ml\u002Fweights_of_layers",title:"Weights of Layers"},next:{slug:"ml\u002Fimage_processing",title:"Image Processing"},section:{file:"ml\u002F28-ml_validation.md",title:"Validation in ML",date:"Jan. 31, 2023",summary:"Cross Validation",tag:["validation","ML"],toc:"\u003Ch4\u003EContents\u003C\u002Fh4\u003E\u003Cp class=\"toc-h2\"\u003E\u003Ca href=\"#stratified-group-k-fold\"\u003EStratified Group K-Fold\u003C\u002Fa\u003E\u003C\u002Fp\u003E\u003Cp class=\"toc-h3\"\u003E\u003Ca href=\"#original-code-with-explanation\"\u003EOriginal code with explanation\u003C\u002Fa\u003E\u003C\u002Fp\u003E\u003Cp class=\"toc-h3\"\u003E\u003Ca href=\"#summary-with-metaphor\"\u003ESummary with metaphor\u003C\u002Fa\u003E\u003C\u002Fp\u003E\u003Cp class=\"toc-h3\"\u003E\u003Ca href=\"#optimized-code-with-numpy-and-pandas\"\u003EOptimized code with numpy and pandas\u003C\u002Fa\u003E\u003C\u002Fp\u003E\u003Cp class=\"toc-h3\"\u003E\u003Ca href=\"#check-distributions-of-splited-data\"\u003ECheck distributions of splited data\u003C\u002Fa\u003E\u003C\u002Fp\u003E\u003Cp class=\"toc-h3\"\u003E\u003Ca href=\"#optimized-code-with-numpy-and-polars\"\u003EOptimized code with numpy and polars\u003C\u002Fa\u003E\u003C\u002Fp\u003E",body:"\u003Ch2 id=\"stratified-group-k-fold\"\u003EStratified Group K-Fold\u003Ca href=\"#stratified-group-k-fold\" class=\"anchor\"\u003E\u003Cspan class=\"visually-hidden\"\u003E#\u003C\u002Fspan\u003E\u003C\u002Fa\u003E\u003C\u002Fh2\u003E\u003Cp\u003EOriginal Code: \u003Ca href=\"https:\u002F\u002Fwww.kaggle.com\u002Fjakubwasikowski\u002Fstratified-group-k-fold-cross-validation\"\u003Ejakubwasikowski’s code\u003C\u002Fa\u003E\u003C\u002Fp\u003E\n\u003Ch3 id=\"original-code-with-explanation\"\u003EOriginal code with explanation\u003Ca href=\"#original-code-with-explanation\" class=\"anchor\"\u003E\u003Cspan class=\"visually-hidden\"\u003E#\u003C\u002Fspan\u003E\u003C\u002Fa\u003E\u003C\u002Fh3\u003E\u003Cdiv class=\"code-block python\"\u003E\u003Cpre class='language-python'\u003E\u003Ccode\u003E\u003Cspan class=\"token comment\"\u003E# %%timeit\u003C\u002Fspan\u003E\n\u003Cspan class=\"token comment\"\u003E# 7.23 s ± 141 ms per loop (mean ± std. dev. of 7 runs, 1 loop each)\u003C\u002Fspan\u003E\n\nlabels_num \u003Cspan class=\"token operator\"\u003E=\u003C\u002Fspan\u003E np\u003Cspan class=\"token punctuation\"\u003E.\u003C\u002Fspan\u003E\u003Cspan class=\"token builtin\"\u003Emax\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E(\u003C\u002Fspan\u003Ey\u003Cspan class=\"token punctuation\"\u003E)\u003C\u002Fspan\u003E \u003Cspan class=\"token operator\"\u003E+\u003C\u002Fspan\u003E \u003Cspan class=\"token number\"\u003E1\u003C\u002Fspan\u003E  \u003Cspan class=\"token comment\"\u003E# label이 0~9로 구성이 되어 있어 최대 값에 1을 더해 label 개수를 파악합니다.\u003C\u002Fspan\u003E\n\u003Cspan class=\"token comment\"\u003E# 각 image 별로 label 개수를 확인하기 위해 지정합니다.\u003C\u002Fspan\u003E\ny_counts_per_group \u003Cspan class=\"token operator\"\u003E=\u003C\u002Fspan\u003E defaultdict\u003Cspan class=\"token punctuation\"\u003E(\u003C\u002Fspan\u003E\u003Cspan class=\"token keyword\"\u003Elambda\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E:\u003C\u002Fspan\u003E np\u003Cspan class=\"token punctuation\"\u003E.\u003C\u002Fspan\u003Ezeros\u003Cspan class=\"token punctuation\"\u003E(\u003C\u002Fspan\u003Elabels_num\u003Cspan class=\"token punctuation\"\u003E)\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E)\u003C\u002Fspan\u003E  \u003Cspan class=\"token comment\"\u003E# dict shape: (n_image, n_label)\u003C\u002Fspan\u003E\n\u003Cspan class=\"token comment\"\u003E# 각 label 별 개수를 확인하기 위해 지정합니다.\u003C\u002Fspan\u003E\ny_distr \u003Cspan class=\"token operator\"\u003E=\u003C\u002Fspan\u003E Counter\u003Cspan class=\"token punctuation\"\u003E(\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E)\u003C\u002Fspan\u003E\n\u003Cspan class=\"token comment\"\u003E# annotation 데이터를 이용해 순차적으로 데이터를 확인합니다.\u003C\u002Fspan\u003E\n\u003Cspan class=\"token keyword\"\u003Efor\u003C\u002Fspan\u003E label\u003Cspan class=\"token punctuation\"\u003E,\u003C\u002Fspan\u003E g \u003Cspan class=\"token keyword\"\u003Ein\u003C\u002Fspan\u003E \u003Cspan class=\"token builtin\"\u003Ezip\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E(\u003C\u002Fspan\u003Ey\u003Cspan class=\"token punctuation\"\u003E,\u003C\u002Fspan\u003E groups\u003Cspan class=\"token punctuation\"\u003E)\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E:\u003C\u002Fspan\u003E\n    y_counts_per_group\u003Cspan class=\"token punctuation\"\u003E[\u003C\u002Fspan\u003Eg\u003Cspan class=\"token punctuation\"\u003E]\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E[\u003C\u002Fspan\u003Elabel\u003Cspan class=\"token punctuation\"\u003E]\u003C\u002Fspan\u003E \u003Cspan class=\"token operator\"\u003E+=\u003C\u002Fspan\u003E \u003Cspan class=\"token number\"\u003E1\u003C\u002Fspan\u003E\n    y_distr\u003Cspan class=\"token punctuation\"\u003E[\u003C\u002Fspan\u003Elabel\u003Cspan class=\"token punctuation\"\u003E]\u003C\u002Fspan\u003E \u003Cspan class=\"token operator\"\u003E+=\u003C\u002Fspan\u003E \u003Cspan class=\"token number\"\u003E1\u003C\u002Fspan\u003E\n\ny_counts_per_fold \u003Cspan class=\"token operator\"\u003E=\u003C\u002Fspan\u003E defaultdict\u003Cspan class=\"token punctuation\"\u003E(\u003C\u002Fspan\u003E\u003Cspan class=\"token keyword\"\u003Elambda\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E:\u003C\u002Fspan\u003E np\u003Cspan class=\"token punctuation\"\u003E.\u003C\u002Fspan\u003Ezeros\u003Cspan class=\"token punctuation\"\u003E(\u003C\u002Fspan\u003Elabels_num\u003Cspan class=\"token punctuation\"\u003E)\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E)\u003C\u002Fspan\u003E  \u003Cspan class=\"token comment\"\u003E# fold별 각 label 개수를 파악하기 위해 지정합니다.\u003C\u002Fspan\u003E\n\n\u003Cspan class=\"token comment\"\u003E# 어떤 image가 특정 fold에 속할 때 전체 fold의 std 값 확인하는 함수입니다.\u003C\u002Fspan\u003E\n\u003Cspan class=\"token keyword\"\u003Edef\u003C\u002Fspan\u003E \u003Cspan class=\"token function\"\u003Eeval_y_counts_per_fold\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E(\u003C\u002Fspan\u003Ey_counts\u003Cspan class=\"token punctuation\"\u003E,\u003C\u002Fspan\u003E fold\u003Cspan class=\"token punctuation\"\u003E)\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E:\u003C\u002Fspan\u003E\n    y_counts_per_fold\u003Cspan class=\"token punctuation\"\u003E[\u003C\u002Fspan\u003Efold\u003Cspan class=\"token punctuation\"\u003E]\u003C\u002Fspan\u003E \u003Cspan class=\"token operator\"\u003E+=\u003C\u002Fspan\u003E y_counts  \u003Cspan class=\"token comment\"\u003E# image가 특정 fold에 속한 것을 반영합니다.\u003C\u002Fspan\u003E\n    std_per_label \u003Cspan class=\"token operator\"\u003E=\u003C\u002Fspan\u003E \u003Cspan class=\"token punctuation\"\u003E[\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E]\u003C\u002Fspan\u003E\n    \u003Cspan class=\"token comment\"\u003E# label 별로 전체 fold에 대해 std 값을 확인합니다.\u003C\u002Fspan\u003E\n    \u003Cspan class=\"token keyword\"\u003Efor\u003C\u002Fspan\u003E label \u003Cspan class=\"token keyword\"\u003Ein\u003C\u002Fspan\u003E \u003Cspan class=\"token builtin\"\u003Erange\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E(\u003C\u002Fspan\u003Elabels_num\u003Cspan class=\"token punctuation\"\u003E)\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E:\u003C\u002Fspan\u003E\n        \u003Cspan class=\"token comment\"\u003E# label 별로 개수가 다르기 때문에 scale을 맞추기 위해 각 label 별 총 개수로 나누어 줍니다.\u003C\u002Fspan\u003E\n        label_std \u003Cspan class=\"token operator\"\u003E=\u003C\u002Fspan\u003E np\u003Cspan class=\"token punctuation\"\u003E.\u003C\u002Fspan\u003Estd\u003Cspan class=\"token punctuation\"\u003E(\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E[\u003C\u002Fspan\u003Ey_counts_per_fold\u003Cspan class=\"token punctuation\"\u003E[\u003C\u002Fspan\u003Ei\u003Cspan class=\"token punctuation\"\u003E]\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E[\u003C\u002Fspan\u003Elabel\u003Cspan class=\"token punctuation\"\u003E]\u003C\u002Fspan\u003E \u003Cspan class=\"token operator\"\u003E\u002F\u003C\u002Fspan\u003E y_distr\u003Cspan class=\"token punctuation\"\u003E[\u003C\u002Fspan\u003Elabel\u003Cspan class=\"token punctuation\"\u003E]\u003C\u002Fspan\u003E \u003Cspan class=\"token keyword\"\u003Efor\u003C\u002Fspan\u003E i \u003Cspan class=\"token keyword\"\u003Ein\u003C\u002Fspan\u003E \u003Cspan class=\"token builtin\"\u003Erange\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E(\u003C\u002Fspan\u003Ek\u003Cspan class=\"token punctuation\"\u003E)\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E]\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E)\u003C\u002Fspan\u003E\n        std_per_label\u003Cspan class=\"token punctuation\"\u003E.\u003C\u002Fspan\u003Eappend\u003Cspan class=\"token punctuation\"\u003E(\u003C\u002Fspan\u003Elabel_std\u003Cspan class=\"token punctuation\"\u003E)\u003C\u002Fspan\u003E\n    \u003Cspan class=\"token comment\"\u003E# 본 함수는 해당 image가 특정 fold에 속한 것을 가정하고 계산합니다. 해당 image가 특정 fold에 속하지 않을 수 있기 때문에 원상 복구 합니다.\u003C\u002Fspan\u003E\n    y_counts_per_fold\u003Cspan class=\"token punctuation\"\u003E[\u003C\u002Fspan\u003Efold\u003Cspan class=\"token punctuation\"\u003E]\u003C\u002Fspan\u003E \u003Cspan class=\"token operator\"\u003E-=\u003C\u002Fspan\u003E y_counts\n    \u003Cspan class=\"token comment\"\u003E# label별 std를 평균냅니다.\u003C\u002Fspan\u003E\n    \u003Cspan class=\"token keyword\"\u003Ereturn\u003C\u002Fspan\u003E np\u003Cspan class=\"token punctuation\"\u003E.\u003C\u002Fspan\u003Emean\u003Cspan class=\"token punctuation\"\u003E(\u003C\u002Fspan\u003Estd_per_label\u003Cspan class=\"token punctuation\"\u003E)\u003C\u002Fspan\u003E\n\n\u003Cspan class=\"token comment\"\u003E# image당 각 label 개수에 대한 값들만 활용합니다.\u003C\u002Fspan\u003E\ngroups_and_y_counts \u003Cspan class=\"token operator\"\u003E=\u003C\u002Fspan\u003E \u003Cspan class=\"token builtin\"\u003Elist\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E(\u003C\u002Fspan\u003Ey_counts_per_group\u003Cspan class=\"token punctuation\"\u003E.\u003C\u002Fspan\u003Eitems\u003Cspan class=\"token punctuation\"\u003E(\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E)\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E)\u003C\u002Fspan\u003E\n\u003Cspan class=\"token comment\"\u003E# shuffle 후 sort 하는 것이 이상해 보이지만, sort 하였을 때 같은 std 값일 경우 순서가 달라지게 됩니다.\u003C\u002Fspan\u003E\nrandom\u003Cspan class=\"token punctuation\"\u003E.\u003C\u002Fspan\u003ERandom\u003Cspan class=\"token punctuation\"\u003E(\u003C\u002Fspan\u003Eseed\u003Cspan class=\"token punctuation\"\u003E)\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E.\u003C\u002Fspan\u003Eshuffle\u003Cspan class=\"token punctuation\"\u003E(\u003C\u002Fspan\u003Egroups_and_y_counts\u003Cspan class=\"token punctuation\"\u003E)\u003C\u002Fspan\u003E\ngroups_per_fold \u003Cspan class=\"token operator\"\u003E=\u003C\u002Fspan\u003E defaultdict\u003Cspan class=\"token punctuation\"\u003E(\u003C\u002Fspan\u003E\u003Cspan class=\"token builtin\"\u003Eset\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E)\u003C\u002Fspan\u003E  \u003Cspan class=\"token comment\"\u003E# 각 fold별 index를 저장하기 위해 지정합니다.\u003C\u002Fspan\u003E\n\n\u003Cspan class=\"token comment\"\u003E# 큰 std를 가진 image부터 순차적으로 best fold를 찾습니다.\u003C\u002Fspan\u003E\n\u003Cspan class=\"token keyword\"\u003Efor\u003C\u002Fspan\u003E g\u003Cspan class=\"token punctuation\"\u003E,\u003C\u002Fspan\u003E y_counts \u003Cspan class=\"token keyword\"\u003Ein\u003C\u002Fspan\u003E \u003Cspan class=\"token builtin\"\u003Esorted\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E(\u003C\u002Fspan\u003Egroups_and_y_counts\u003Cspan class=\"token punctuation\"\u003E,\u003C\u002Fspan\u003E key\u003Cspan class=\"token operator\"\u003E=\u003C\u002Fspan\u003E\u003Cspan class=\"token keyword\"\u003Elambda\u003C\u002Fspan\u003E x\u003Cspan class=\"token punctuation\"\u003E:\u003C\u002Fspan\u003E \u003Cspan class=\"token operator\"\u003E-\u003C\u002Fspan\u003Enp\u003Cspan class=\"token punctuation\"\u003E.\u003C\u002Fspan\u003Estd\u003Cspan class=\"token punctuation\"\u003E(\u003C\u002Fspan\u003Ex\u003Cspan class=\"token punctuation\"\u003E[\u003C\u002Fspan\u003E\u003Cspan class=\"token number\"\u003E1\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E]\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E)\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E)\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E:\u003C\u002Fspan\u003E\n    best_fold \u003Cspan class=\"token operator\"\u003E=\u003C\u002Fspan\u003E \u003Cspan class=\"token boolean\"\u003ENone\u003C\u002Fspan\u003E\n    min_eval \u003Cspan class=\"token operator\"\u003E=\u003C\u002Fspan\u003E \u003Cspan class=\"token boolean\"\u003ENone\u003C\u002Fspan\u003E\n    \u003Cspan class=\"token comment\"\u003E# image가 어떤 fold에 속할 때 가장 낮은 std를 가지는지 확인하는 과정입니다.\u003C\u002Fspan\u003E\n    \u003Cspan class=\"token keyword\"\u003Efor\u003C\u002Fspan\u003E i \u003Cspan class=\"token keyword\"\u003Ein\u003C\u002Fspan\u003E \u003Cspan class=\"token builtin\"\u003Erange\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E(\u003C\u002Fspan\u003Ek\u003Cspan class=\"token punctuation\"\u003E)\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E:\u003C\u002Fspan\u003E  \u003Cspan class=\"token comment\"\u003E# 각 fold에 대해 순차적으로 확인합니다.\u003C\u002Fspan\u003E\n        fold_eval \u003Cspan class=\"token operator\"\u003E=\u003C\u002Fspan\u003E eval_y_counts_per_fold\u003Cspan class=\"token punctuation\"\u003E(\u003C\u002Fspan\u003Ey_counts\u003Cspan class=\"token punctuation\"\u003E,\u003C\u002Fspan\u003E i\u003Cspan class=\"token punctuation\"\u003E)\u003C\u002Fspan\u003E  \u003Cspan class=\"token comment\"\u003E# 전체 fold에 대해 std값 확인.\u003C\u002Fspan\u003E\n        \u003Cspan class=\"token comment\"\u003E# std 값이 가장 낮을 때가 best fold 입니다.\u003C\u002Fspan\u003E\n        \u003Cspan class=\"token keyword\"\u003Eif\u003C\u002Fspan\u003E min_eval \u003Cspan class=\"token keyword\"\u003Eis\u003C\u002Fspan\u003E \u003Cspan class=\"token boolean\"\u003ENone\u003C\u002Fspan\u003E \u003Cspan class=\"token keyword\"\u003Eor\u003C\u002Fspan\u003E fold_eval \u003Cspan class=\"token operator\"\u003E&lt;\u003C\u002Fspan\u003E min_eval\u003Cspan class=\"token punctuation\"\u003E:\u003C\u002Fspan\u003E\n            min_eval \u003Cspan class=\"token operator\"\u003E=\u003C\u002Fspan\u003E fold_eval\n            best_fold \u003Cspan class=\"token operator\"\u003E=\u003C\u002Fspan\u003E i\n    y_counts_per_fold\u003Cspan class=\"token punctuation\"\u003E[\u003C\u002Fspan\u003Ebest_fold\u003Cspan class=\"token punctuation\"\u003E]\u003C\u002Fspan\u003E \u003Cspan class=\"token operator\"\u003E+=\u003C\u002Fspan\u003E y_counts  \u003Cspan class=\"token comment\"\u003E# best fold를 확정하고 해당 image를 반영합니다.\u003C\u002Fspan\u003E\n    groups_per_fold\u003Cspan class=\"token punctuation\"\u003E[\u003C\u002Fspan\u003Ebest_fold\u003Cspan class=\"token punctuation\"\u003E]\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E.\u003C\u002Fspan\u003Eadd\u003Cspan class=\"token punctuation\"\u003E(\u003C\u002Fspan\u003Eg\u003Cspan class=\"token punctuation\"\u003E)\u003C\u002Fspan\u003E  \u003Cspan class=\"token comment\"\u003E# best fold에 해당 이미지의 index를 추가합니다.\u003C\u002Fspan\u003E\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\u003C\u002Fdiv\u003E\u003Ch3 id=\"summary-with-metaphor\"\u003ESummary with metaphor\u003Ca href=\"#summary-with-metaphor\" class=\"anchor\"\u003E\u003Cspan class=\"visually-hidden\"\u003E#\u003C\u002Fspan\u003E\u003C\u002Fa\u003E\u003C\u002Fh3\u003E\u003Cp\u003E다양한 크기의 감자(image)를 수확했습니다. (갑자기?) 우리는 이것을 5개 상자(fold)에 나누어 담아야 합니다.\u003C\u002Fp\u003E\n\u003Cp\u003E하지만! 5개의 상자에 다양한 크기의 감자들이 골고루 담겨야 하며, 5개 상자 무게 모두 동일해야 합니다. (예?!)\u003C\u002Fp\u003E\n\u003Cp\u003E다양한 크기의 감자를 상자에 넣기 위해서는 큰 감자는 가장 먼저 넣는게 좋을 것 같네요.\u003C\u002Fp\u003E\n\u003Cp\u003E큰 감자는 나중에 넣게 되면 쉽게 넘칠 수 있고 무게 또한 많이 달라지기 때문에 가장 먼저 넣는게 좋을 것 같습니다. 정리를 할 때도 큰 것을 먼저 배치하면 좋다고 하니까요..\u003C\u002Fp\u003E\n\u003Cp\u003E큰 감자부터 순서대로 차곡차곡 상자에 담습니다. 중간 중간 무게도 확인하면서요.\u003C\u002Fp\u003E\n\u003Cp\u003E그 결과 상자별 감자 개수는 다를지 몰라도 다양한 크기를 가진 감자들이 균일하게 담긴 것 같네요.\u003C\u002Fp\u003E\n\u003Cp\u003E\u003Cimg src=\"https:\u002F\u002Fs3-us-west-2.amazonaws.com\u002Faistages-prod-server-public\u002Fapp\u002FUsers\u002F00000526\u002Ffiles\u002F54c3f53b-8534-49f9-a594-d6aeffae568f..png\" alt=\"https:\u002F\u002Fs3-us-west-2.amazonaws.com\u002Faistages-prod-server-public\u002Fapp\u002FUsers\u002F00000526\u002Ffiles\u002F54c3f53b-8534-49f9-a594-d6aeffae568f..png\"\u003E\u003C\u002Fp\u003E\n\u003Cp\u003E그렇군요. 감자하게도 잘 된 것 같네요. :ㅇ\u003C\u002Fp\u003E\n\u003Cp\u003E(정확한 설명은 아니지만 이런 뉘앙스를 가진다 이해해주시면 감사하겠습니다.)\u003C\u002Fp\u003E\n\u003Cp\u003E마지막으로 좀 더 선별을 잘 하기 위해 최신 저울(pandas, numpy)을 도입하기로 했습니다.\u003C\u002Fp\u003E\n\u003Ch3 id=\"optimized-code-with-numpy-and-pandas\"\u003EOptimized code with numpy and pandas\u003Ca href=\"#optimized-code-with-numpy-and-pandas\" class=\"anchor\"\u003E\u003Cspan class=\"visually-hidden\"\u003E#\u003C\u002Fspan\u003E\u003C\u002Fa\u003E\u003C\u002Fh3\u003E\u003Cdiv class=\"code-block python\"\u003E\u003Cpre class='language-python'\u003E\u003Ccode\u003E\u003Cspan class=\"token comment\"\u003E# %%timeit\u003C\u002Fspan\u003E\n\u003Cspan class=\"token comment\"\u003E# 838 ms ± 28.1 ms per loop (mean ± std. dev. of 7 runs, 1 loop each)\u003C\u002Fspan\u003E\n\nlabels_num \u003Cspan class=\"token operator\"\u003E=\u003C\u002Fspan\u003E y\u003Cspan class=\"token punctuation\"\u003E.\u003C\u002Fspan\u003E\u003Cspan class=\"token builtin\"\u003Emax\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E(\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E)\u003C\u002Fspan\u003E \u003Cspan class=\"token operator\"\u003E+\u003C\u002Fspan\u003E \u003Cspan class=\"token number\"\u003E1\u003C\u002Fspan\u003E\n\u003Cspan class=\"token comment\"\u003E# https:\u002F\u002Fstackoverflow.com\u002Fa\u002F39132900\u002F14019325\u003C\u002Fspan\u003E\n\u003Cspan class=\"token comment\"\u003E# 기존 코드의 첫번째 loop와 동일합니다. 각 image 별 label 개수를 확인합니다.\u003C\u002Fspan\u003E\ny_counts_per_group \u003Cspan class=\"token operator\"\u003E=\u003C\u002Fspan\u003E df\u003Cspan class=\"token punctuation\"\u003E.\u003C\u002Fspan\u003Egroupby\u003Cspan class=\"token punctuation\"\u003E(\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E[\u003C\u002Fspan\u003E\u003Cspan class=\"token string\"\u003E'image_id'\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E,\u003C\u002Fspan\u003E \u003Cspan class=\"token string\"\u003E'category_id'\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E]\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E)\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E.\u003C\u002Fspan\u003Esize\u003Cspan class=\"token punctuation\"\u003E(\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E)\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E.\u003C\u002Fspan\u003Eunstack\u003Cspan class=\"token punctuation\"\u003E(\u003C\u002Fspan\u003Efill_value\u003Cspan class=\"token operator\"\u003E=\u003C\u002Fspan\u003E\u003Cspan class=\"token number\"\u003E0\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E)\u003C\u002Fspan\u003E\ny_counts_per_fold \u003Cspan class=\"token operator\"\u003E=\u003C\u002Fspan\u003E np\u003Cspan class=\"token punctuation\"\u003E.\u003C\u002Fspan\u003Ezeros\u003Cspan class=\"token punctuation\"\u003E(\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E(\u003C\u002Fspan\u003Ek\u003Cspan class=\"token punctuation\"\u003E,\u003C\u002Fspan\u003E labels_num\u003Cspan class=\"token punctuation\"\u003E)\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E)\u003C\u002Fspan\u003E\n\n\u003Cspan class=\"token comment\"\u003E# scale을 미리 계산하여 연산을 줄입니다.\u003C\u002Fspan\u003E\ny_norm_counts_per_group \u003Cspan class=\"token operator\"\u003E=\u003C\u002Fspan\u003E y_counts_per_group \u003Cspan class=\"token operator\"\u003E\u002F\u003C\u002Fspan\u003E y_counts_per_group\u003Cspan class=\"token punctuation\"\u003E.\u003C\u002Fspan\u003E\u003Cspan class=\"token builtin\"\u003Esum\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E(\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E)\u003C\u002Fspan\u003E\n\u003Cspan class=\"token comment\"\u003E# suffle &amp; sort\u003C\u002Fspan\u003E\nshuffled_and_sorted_index \u003Cspan class=\"token operator\"\u003E=\u003C\u002Fspan\u003E y_norm_counts_per_group\u003Cspan class=\"token punctuation\"\u003E.\u003C\u002Fspan\u003Esample\u003Cspan class=\"token punctuation\"\u003E(\u003C\u002Fspan\u003Efrac\u003Cspan class=\"token operator\"\u003E=\u003C\u002Fspan\u003E\u003Cspan class=\"token number\"\u003E1\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E,\u003C\u002Fspan\u003E random_state\u003Cspan class=\"token operator\"\u003E=\u003C\u002Fspan\u003Eseed\u003Cspan class=\"token punctuation\"\u003E)\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E.\u003C\u002Fspan\u003Estd\u003Cspan class=\"token punctuation\"\u003E(\u003C\u002Fspan\u003Eaxis\u003Cspan class=\"token operator\"\u003E=\u003C\u002Fspan\u003E\u003Cspan class=\"token number\"\u003E1\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E)\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E.\u003C\u002Fspan\u003Esort_values\u003Cspan class=\"token punctuation\"\u003E(\u003C\u002Fspan\u003Eascending\u003Cspan class=\"token operator\"\u003E=\u003C\u002Fspan\u003E\u003Cspan class=\"token boolean\"\u003EFalse\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E)\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E.\u003C\u002Fspan\u003Eindex\ny_norm_counts_per_group \u003Cspan class=\"token operator\"\u003E=\u003C\u002Fspan\u003E y_norm_counts_per_group\u003Cspan class=\"token punctuation\"\u003E.\u003C\u002Fspan\u003Eloc\u003Cspan class=\"token punctuation\"\u003E[\u003C\u002Fspan\u003Eshuffled_and_sorted_index\u003Cspan class=\"token punctuation\"\u003E]\u003C\u002Fspan\u003E\n\ngroups_per_fold \u003Cspan class=\"token operator\"\u003E=\u003C\u002Fspan\u003E defaultdict\u003Cspan class=\"token punctuation\"\u003E(\u003C\u002Fspan\u003E\u003Cspan class=\"token builtin\"\u003Eset\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E)\u003C\u002Fspan\u003E\n\n\u003Cspan class=\"token keyword\"\u003Efor\u003C\u002Fspan\u003E g\u003Cspan class=\"token punctuation\"\u003E,\u003C\u002Fspan\u003E y_counts \u003Cspan class=\"token keyword\"\u003Ein\u003C\u002Fspan\u003E \u003Cspan class=\"token builtin\"\u003Ezip\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E(\u003C\u002Fspan\u003Ey_norm_counts_per_group\u003Cspan class=\"token punctuation\"\u003E.\u003C\u002Fspan\u003Eindex\u003Cspan class=\"token punctuation\"\u003E,\u003C\u002Fspan\u003E y_norm_counts_per_group\u003Cspan class=\"token punctuation\"\u003E.\u003C\u002Fspan\u003Evalues\u003Cspan class=\"token punctuation\"\u003E)\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E:\u003C\u002Fspan\u003E\n    best_fold \u003Cspan class=\"token operator\"\u003E=\u003C\u002Fspan\u003E \u003Cspan class=\"token boolean\"\u003ENone\u003C\u002Fspan\u003E\n    min_eval \u003Cspan class=\"token operator\"\u003E=\u003C\u002Fspan\u003E \u003Cspan class=\"token boolean\"\u003ENone\u003C\u002Fspan\u003E\n    \u003Cspan class=\"token keyword\"\u003Efor\u003C\u002Fspan\u003E fold_i \u003Cspan class=\"token keyword\"\u003Ein\u003C\u002Fspan\u003E \u003Cspan class=\"token builtin\"\u003Erange\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E(\u003C\u002Fspan\u003Ek\u003Cspan class=\"token punctuation\"\u003E)\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E:\u003C\u002Fspan\u003E\n        \u003Cspan class=\"token comment\"\u003E# 기존 코드 eval_y_counts_per_fold 와 동일합니다.\u003C\u002Fspan\u003E\n        y_counts_per_fold\u003Cspan class=\"token punctuation\"\u003E[\u003C\u002Fspan\u003Efold_i\u003Cspan class=\"token punctuation\"\u003E]\u003C\u002Fspan\u003E \u003Cspan class=\"token operator\"\u003E+=\u003C\u002Fspan\u003E y_counts\n        fold_eval \u003Cspan class=\"token operator\"\u003E=\u003C\u002Fspan\u003E y_counts_per_fold\u003Cspan class=\"token punctuation\"\u003E.\u003C\u002Fspan\u003Estd\u003Cspan class=\"token punctuation\"\u003E(\u003C\u002Fspan\u003Eaxis\u003Cspan class=\"token operator\"\u003E=\u003C\u002Fspan\u003E\u003Cspan class=\"token number\"\u003E0\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E)\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E.\u003C\u002Fspan\u003Emean\u003Cspan class=\"token punctuation\"\u003E(\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E)\u003C\u002Fspan\u003E  \u003Cspan class=\"token comment\"\u003E# numpy를 활용하여 연산을 단순화 합니다.\u003C\u002Fspan\u003E\n        \u003Cspan class=\"token comment\"\u003E# `.std(axis=0)` 각 label 별 std 계산 후 평균\u003C\u002Fspan\u003E\n        y_counts_per_fold\u003Cspan class=\"token punctuation\"\u003E[\u003C\u002Fspan\u003Efold_i\u003Cspan class=\"token punctuation\"\u003E]\u003C\u002Fspan\u003E \u003Cspan class=\"token operator\"\u003E-=\u003C\u002Fspan\u003E y_counts\n        \u003Cspan class=\"token keyword\"\u003Eif\u003C\u002Fspan\u003E min_eval \u003Cspan class=\"token keyword\"\u003Eis\u003C\u002Fspan\u003E \u003Cspan class=\"token boolean\"\u003ENone\u003C\u002Fspan\u003E \u003Cspan class=\"token keyword\"\u003Eor\u003C\u002Fspan\u003E fold_eval \u003Cspan class=\"token operator\"\u003E&lt;\u003C\u002Fspan\u003E min_eval\u003Cspan class=\"token punctuation\"\u003E:\u003C\u002Fspan\u003E\n            min_eval \u003Cspan class=\"token operator\"\u003E=\u003C\u002Fspan\u003E fold_eval\n            best_fold \u003Cspan class=\"token operator\"\u003E=\u003C\u002Fspan\u003E fold_i\n    y_counts_per_fold\u003Cspan class=\"token punctuation\"\u003E[\u003C\u002Fspan\u003Ebest_fold\u003Cspan class=\"token punctuation\"\u003E]\u003C\u002Fspan\u003E \u003Cspan class=\"token operator\"\u003E+=\u003C\u002Fspan\u003E y_counts\n    groups_per_fold\u003Cspan class=\"token punctuation\"\u003E[\u003C\u002Fspan\u003Ebest_fold\u003Cspan class=\"token punctuation\"\u003E]\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E.\u003C\u002Fspan\u003Eadd\u003Cspan class=\"token punctuation\"\u003E(\u003C\u002Fspan\u003Eg\u003Cspan class=\"token punctuation\"\u003E)\u003C\u002Fspan\u003E\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\u003C\u002Fdiv\u003E\u003Cp\u003E최신 저울을 추가했더니 속도가 확실히 빨라졌네요. 7.23s –&gt; 0.84s 로 개선이 됐습니다.\u003C\u002Fp\u003E\n\u003Cp\u003Epandas와 numpy를 활용해 loop 수를 최소화 하여 간략화 한것이 도움이 됐습니다.\u003C\u002Fp\u003E\n\u003Ch3 id=\"check-distributions-of-splited-data\"\u003ECheck distributions of splited data\u003Ca href=\"#check-distributions-of-splited-data\" class=\"anchor\"\u003E\u003Cspan class=\"visually-hidden\"\u003E#\u003C\u002Fspan\u003E\u003C\u002Fa\u003E\u003C\u002Fh3\u003E\u003Cdiv class=\"code-block python\"\u003E\u003Cpre class='language-python'\u003E\u003Ccode\u003E\u003Cspan class=\"token keyword\"\u003Edef\u003C\u002Fspan\u003E \u003Cspan class=\"token function\"\u003Eget_distribution\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E(\u003C\u002Fspan\u003Ey_vals\u003Cspan class=\"token punctuation\"\u003E)\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E:\u003C\u002Fspan\u003E\n        y_distr \u003Cspan class=\"token operator\"\u003E=\u003C\u002Fspan\u003E Counter\u003Cspan class=\"token punctuation\"\u003E(\u003C\u002Fspan\u003Ey_vals\u003Cspan class=\"token punctuation\"\u003E)\u003C\u002Fspan\u003E\n        y_vals_sum \u003Cspan class=\"token operator\"\u003E=\u003C\u002Fspan\u003E \u003Cspan class=\"token builtin\"\u003Esum\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E(\u003C\u002Fspan\u003Ey_distr\u003Cspan class=\"token punctuation\"\u003E.\u003C\u002Fspan\u003Evalues\u003Cspan class=\"token punctuation\"\u003E(\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E)\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E)\u003C\u002Fspan\u003E\n        \u003Cspan class=\"token keyword\"\u003Ereturn\u003C\u002Fspan\u003E \u003Cspan class=\"token punctuation\"\u003E[\u003C\u002Fspan\u003E\u003Cspan class=\"token string-interpolation\"\u003E\u003Cspan class=\"token string\"\u003Ef'\u003C\u002Fspan\u003E\u003Cspan class=\"token interpolation\"\u003E\u003Cspan class=\"token punctuation\"\u003E{\u003C\u002Fspan\u003Ey_distr\u003Cspan class=\"token punctuation\"\u003E[\u003C\u002Fspan\u003Ei\u003Cspan class=\"token punctuation\"\u003E]\u003C\u002Fspan\u003E \u003Cspan class=\"token operator\"\u003E\u002F\u003C\u002Fspan\u003E y_vals_sum\u003Cspan class=\"token punctuation\"\u003E:\u003C\u002Fspan\u003E\u003Cspan class=\"token format-spec\"\u003E.2%\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E}\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E\u003Cspan class=\"token string\"\u003E'\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E \u003Cspan class=\"token keyword\"\u003Efor\u003C\u002Fspan\u003E i \u003Cspan class=\"token keyword\"\u003Ein\u003C\u002Fspan\u003E \u003Cspan class=\"token builtin\"\u003Erange\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E(\u003C\u002Fspan\u003Enp\u003Cspan class=\"token punctuation\"\u003E.\u003C\u002Fspan\u003E\u003Cspan class=\"token builtin\"\u003Emax\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E(\u003C\u002Fspan\u003Ey_vals\u003Cspan class=\"token punctuation\"\u003E)\u003C\u002Fspan\u003E \u003Cspan class=\"token operator\"\u003E+\u003C\u002Fspan\u003E \u003Cspan class=\"token number\"\u003E1\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E)\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E]\u003C\u002Fspan\u003E\n\nall_groups \u003Cspan class=\"token operator\"\u003E=\u003C\u002Fspan\u003E \u003Cspan class=\"token builtin\"\u003Eset\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E(\u003C\u002Fspan\u003Egroups\u003Cspan class=\"token punctuation\"\u003E)\u003C\u002Fspan\u003E\n\ndistrs \u003Cspan class=\"token operator\"\u003E=\u003C\u002Fspan\u003E \u003Cspan class=\"token punctuation\"\u003E[\u003C\u002Fspan\u003Eget_distribution\u003Cspan class=\"token punctuation\"\u003E(\u003C\u002Fspan\u003Ey\u003Cspan class=\"token punctuation\"\u003E)\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E]\u003C\u002Fspan\u003E\nindex \u003Cspan class=\"token operator\"\u003E=\u003C\u002Fspan\u003E \u003Cspan class=\"token punctuation\"\u003E[\u003C\u002Fspan\u003E\u003Cspan class=\"token string\"\u003E'training set'\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E]\u003C\u002Fspan\u003E\n\n\u003Cspan class=\"token keyword\"\u003Efor\u003C\u002Fspan\u003E i \u003Cspan class=\"token keyword\"\u003Ein\u003C\u002Fspan\u003E \u003Cspan class=\"token builtin\"\u003Erange\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E(\u003C\u002Fspan\u003Ek\u003Cspan class=\"token punctuation\"\u003E)\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E:\u003C\u002Fspan\u003E\n    train_groups \u003Cspan class=\"token operator\"\u003E=\u003C\u002Fspan\u003E all_groups \u003Cspan class=\"token operator\"\u003E-\u003C\u002Fspan\u003E groups_per_fold\u003Cspan class=\"token punctuation\"\u003E[\u003C\u002Fspan\u003Ei\u003Cspan class=\"token punctuation\"\u003E]\u003C\u002Fspan\u003E\n    test_groups \u003Cspan class=\"token operator\"\u003E=\u003C\u002Fspan\u003E groups_per_fold\u003Cspan class=\"token punctuation\"\u003E[\u003C\u002Fspan\u003Ei\u003Cspan class=\"token punctuation\"\u003E]\u003C\u002Fspan\u003E\n\n    train_df \u003Cspan class=\"token operator\"\u003E=\u003C\u002Fspan\u003E df\u003Cspan class=\"token punctuation\"\u003E.\u003C\u002Fspan\u003Eloc\u003Cspan class=\"token punctuation\"\u003E[\u003C\u002Fspan\u003Edf\u003Cspan class=\"token punctuation\"\u003E[\u003C\u002Fspan\u003E\u003Cspan class=\"token string\"\u003E'image_id'\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E]\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E.\u003C\u002Fspan\u003Eisin\u003Cspan class=\"token punctuation\"\u003E(\u003C\u002Fspan\u003Etrain_groups\u003Cspan class=\"token punctuation\"\u003E)\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E]\u003C\u002Fspan\u003E\n    valid_df \u003Cspan class=\"token operator\"\u003E=\u003C\u002Fspan\u003E df\u003Cspan class=\"token punctuation\"\u003E.\u003C\u002Fspan\u003Eloc\u003Cspan class=\"token punctuation\"\u003E[\u003C\u002Fspan\u003Edf\u003Cspan class=\"token punctuation\"\u003E[\u003C\u002Fspan\u003E\u003Cspan class=\"token string\"\u003E'image_id'\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E]\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E.\u003C\u002Fspan\u003Eisin\u003Cspan class=\"token punctuation\"\u003E(\u003C\u002Fspan\u003Etest_groups\u003Cspan class=\"token punctuation\"\u003E)\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E]\u003C\u002Fspan\u003E\n\n    distrs\u003Cspan class=\"token punctuation\"\u003E.\u003C\u002Fspan\u003Eappend\u003Cspan class=\"token punctuation\"\u003E(\u003C\u002Fspan\u003Eget_distribution\u003Cspan class=\"token punctuation\"\u003E(\u003C\u002Fspan\u003Etrain_df\u003Cspan class=\"token punctuation\"\u003E[\u003C\u002Fspan\u003E\u003Cspan class=\"token string\"\u003E'category_id'\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E]\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E.\u003C\u002Fspan\u003Evalues\u003Cspan class=\"token punctuation\"\u003E)\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E)\u003C\u002Fspan\u003E\n    index\u003Cspan class=\"token punctuation\"\u003E.\u003C\u002Fspan\u003Eappend\u003Cspan class=\"token punctuation\"\u003E(\u003C\u002Fspan\u003E\u003Cspan class=\"token string-interpolation\"\u003E\u003Cspan class=\"token string\"\u003Ef'train set - fold \u003C\u002Fspan\u003E\u003Cspan class=\"token interpolation\"\u003E\u003Cspan class=\"token punctuation\"\u003E{\u003C\u002Fspan\u003Ei \u003Cspan class=\"token operator\"\u003E+\u003C\u002Fspan\u003E \u003Cspan class=\"token number\"\u003E1\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E}\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E\u003Cspan class=\"token string\"\u003E'\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E)\u003C\u002Fspan\u003E\n    distrs\u003Cspan class=\"token punctuation\"\u003E.\u003C\u002Fspan\u003Eappend\u003Cspan class=\"token punctuation\"\u003E(\u003C\u002Fspan\u003Eget_distribution\u003Cspan class=\"token punctuation\"\u003E(\u003C\u002Fspan\u003Evalid_df\u003Cspan class=\"token punctuation\"\u003E[\u003C\u002Fspan\u003E\u003Cspan class=\"token string\"\u003E'category_id'\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E]\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E.\u003C\u002Fspan\u003Evalues\u003Cspan class=\"token punctuation\"\u003E)\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E)\u003C\u002Fspan\u003E\n    index\u003Cspan class=\"token punctuation\"\u003E.\u003C\u002Fspan\u003Eappend\u003Cspan class=\"token punctuation\"\u003E(\u003C\u002Fspan\u003E\u003Cspan class=\"token string-interpolation\"\u003E\u003Cspan class=\"token string\"\u003Ef'validation set - fold \u003C\u002Fspan\u003E\u003Cspan class=\"token interpolation\"\u003E\u003Cspan class=\"token punctuation\"\u003E{\u003C\u002Fspan\u003Ei \u003Cspan class=\"token operator\"\u003E+\u003C\u002Fspan\u003E \u003Cspan class=\"token number\"\u003E1\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E}\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E\u003Cspan class=\"token string\"\u003E'\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E)\u003C\u002Fspan\u003E\n\n\u003Cspan class=\"token keyword\"\u003Eprint\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E(\u003C\u002Fspan\u003E\u003Cspan class=\"token string\"\u003E'Distribution per class:'\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E)\u003C\u002Fspan\u003E\npd\u003Cspan class=\"token punctuation\"\u003E.\u003C\u002Fspan\u003EDataFrame\u003Cspan class=\"token punctuation\"\u003E(\u003C\u002Fspan\u003Edistrs\u003Cspan class=\"token punctuation\"\u003E,\u003C\u002Fspan\u003E index\u003Cspan class=\"token operator\"\u003E=\u003C\u002Fspan\u003Eindex\u003Cspan class=\"token punctuation\"\u003E,\u003C\u002Fspan\u003E columns\u003Cspan class=\"token operator\"\u003E=\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E[\u003C\u002Fspan\u003E\u003Cspan class=\"token string-interpolation\"\u003E\u003Cspan class=\"token string\"\u003Ef'Label \u003C\u002Fspan\u003E\u003Cspan class=\"token interpolation\"\u003E\u003Cspan class=\"token punctuation\"\u003E{\u003C\u002Fspan\u003El\u003Cspan class=\"token punctuation\"\u003E}\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E\u003Cspan class=\"token string\"\u003E'\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E \u003Cspan class=\"token keyword\"\u003Efor\u003C\u002Fspan\u003E l \u003Cspan class=\"token keyword\"\u003Ein\u003C\u002Fspan\u003E \u003Cspan class=\"token builtin\"\u003Erange\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E(\u003C\u002Fspan\u003Enp\u003Cspan class=\"token punctuation\"\u003E.\u003C\u002Fspan\u003E\u003Cspan class=\"token builtin\"\u003Emax\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E(\u003C\u002Fspan\u003Ey\u003Cspan class=\"token punctuation\"\u003E)\u003C\u002Fspan\u003E \u003Cspan class=\"token operator\"\u003E+\u003C\u002Fspan\u003E \u003Cspan class=\"token number\"\u003E1\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E)\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E]\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E)\u003C\u002Fspan\u003E\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\u003C\u002Fdiv\u003E\u003Ch3 id=\"optimized-code-with-numpy-and-polars\"\u003EOptimized code with numpy and polars\u003Ca href=\"#optimized-code-with-numpy-and-polars\" class=\"anchor\"\u003E\u003Cspan class=\"visually-hidden\"\u003E#\u003C\u002Fspan\u003E\u003C\u002Fa\u003E\u003C\u002Fh3\u003E\u003Cp\u003ENot yet implemented.\u003C\u002Fp\u003E\n"}},"uses":{"params":["path","slug"]}}];

					Promise.all([
						import("../_app/immutable/entry/start.515f0d26.js"),
						import("../_app/immutable/entry/app.8b861ad3.js")
					]).then(([kit, app]) => {
						kit.start(app, __sveltekit_1kwx0yh.element, {
							node_ids: [0, 4],
							data,
							form: null,
							error: null
						});
					});
				}
			</script>
		</div>
	</body>
</html>
